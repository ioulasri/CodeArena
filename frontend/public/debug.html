<!DOCTYPE html>
<html>
<head>
    <title>CodeArena Debug</title>
    <style>
        body {
            background: #000;
            color: #0f0;
            font-family: monospace;
            padding: 20px;
        }
        .test {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #0f0;
        }
        .error { color: #f00; }
        .success { color: #0f0; }
    </style>
</head>
<body>
    <h1>CodeArena Connection Test</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function log(msg, isError = false) {
            const div = document.createElement('div');
            div.className = 'test ' + (isError ? 'error' : 'success');
            div.textContent = msg;
            results.appendChild(div);
        }
        
        // Test API connectivity
        log('Testing API connection...');
        
        fetch('http://192.168.100.2:8000/api/v1/auth/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username: 'admin', password: 'admin123' })
        })
        .then(res => {
            log('API Response Status: ' + res.status);
            return res.json();
        })
        .then(data => {
            log('Login successful!');
            log('Token: ' + data.access_token.substring(0, 20) + '...');
            
            // Test token verification
            return fetch('http://192.168.100.2:8000/api/v1/auth/me', {
                headers: { 'Authorization': 'Bearer ' + data.access_token }
            });
        })
        .then(res => {
            log('Token verification status: ' + res.status);
            return res.json();
        })
        .then(user => {
            log('User data: ' + JSON.stringify(user));
        })
        .catch(err => {
            log('ERROR: ' + err.message, true);
        });
    </script>
</body>
</html>
